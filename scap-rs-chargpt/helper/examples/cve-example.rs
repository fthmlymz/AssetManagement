use nvd_cves::v4::CVEContainer;
use std::fs::File;
use std::io::BufReader;
// 下载数据
// curl -o- -s -k -v https://nvd.nist.gov/vuln/data-feeds >data-feeds.html
// cat data-feeds.html|grep  -Eo '(/feeds/[^"]*\.gz)'|xargs -I % wget -c https://nvd.nist.gov%
fn main() {
  let gz_open_file = File::open("examples/nvdcve/nvdcve-1.1-2023.json.gz").unwrap();
  let gz_decoder = flate2::read::GzDecoder::new(gz_open_file);
  let file = BufReader::new(gz_decoder);
  let c: CVEContainer = serde_json::from_reader(file).unwrap();
  println!("{:#?}", c.CVE_data_timestamp);
  if let Some(cve_item) = c.CVE_Items.into_iter().next() {
    println!("{:#?}", &cve_item);
    println!("{}", serde_json::to_string_pretty(&cve_item).unwrap());
  }
}
